var I=(S,d,g)=>new Promise((E,x)=>{var A=u=>{try{h(g.next(u))}catch(n){x(n)}},D=u=>{try{h(g.throw(u))}catch(n){x(n)}},h=u=>u.done?E(u.value):Promise.resolve(u.value).then(A,D);h((g=g.apply(S,d)).next())});import{d as q,y as i,A as L,c as f,o as c,e as a,b as o,h as r,u as C,ax as J,r as T,w as K,m as O,ay as P,F as b,l as w,az as Q,f as W,p as X,aA as z,i as Y,g as N,a2 as U,t as F,aB as Z,n as ee,aC as te,aD as ae,aE as oe,aF as le,aG as ne,aH as se,_ as ie}from"./index-oHwlPX18.js";const ce={class:"welcome-message"},ue={class:"message-input-container"},re={class:"input-container"},de={key:0,class:"upload-status"},pe={class:"button-group"},fe={class:"feature-section slide-in"},me=["onClick"],_e=q({__name:"index",setup(S){i([{title:"新的课程安排发布",content:"本学期的部分课程安排已经更新，请各位同学及时查看。",date:"2024-11-01"},{title:"考试时间调整",content:"原定于下周的数学考试时间调整到下下周，请同学们做好准备。",date:"2024-10-25"}]);const d=Y(),h=i([{icon:te,title:"课程管理",description:"查看和管理本学期的课程安排。",color:"#f7f7f7",onClick:()=>{d.push("/schedule")}},{icon:ae,title:"批假申请",description:"查看各班级各科学生成绩",color:"#f7f7f7",onClick:()=>{d.push("/applicant")}},{icon:oe,title:"考勤管理",description:"管理学生的考勤情况。",color:"#f7f7f7",onClick:()=>d.push("/attendance")},{icon:le,title:"考试管理",description:"查询和调整考试时间表。",color:"#f7f7f7",onClick:()=>{d.push("/exam")}},{icon:ne,title:"学生成绩查询",description:"查看各班级各科学生成绩",color:"#f7f7f7",onClick:()=>{d.push("/testresults")}},{icon:se,title:"关于本系统",description:"查看本系统的相关信息。",color:"#f7f7f7",onClick:()=>{d.push("/about")}}]);i(""),i(!1),i("");const u=L(()=>Array.from({length:Math.ceil(h.value.length/4)},(e,t)=>h.value.slice(t*4,t*4+4))),n=i(""),m=i([]),y=i(!1),R=L(()=>n.value.trim()!==""||m.value.length>0),B={pdf:"el-icon-document",doc:"el-icon-document",docx:"el-icon-document",xls:"el-icon-s-data",xlsx:"el-icon-s-data",ppt:"el-icon-picture-outline-round",pptx:"el-icon-picture-outline-round",jpg:"el-icon-picture",jpeg:"el-icon-picture",png:"el-icon-picture",zip:"el-icon-folder",rar:"el-icon-folder",default:"el-icon-paperclip"},$=l=>{const e=l.target,t=e.files;t&&t.length>0&&(Array.from(t).forEach(s=>{var _;const k=((_=s.name.split(".").pop())==null?void 0:_.toLowerCase())||"default",p=B[k]||B.default;m.value.push({name:s.name,icon:p,file:s})}),e.value="")},j=l=>{m.value.splice(l,1)},M=i(""),G=()=>I(this,null,function*(){var l;if(!y.value){y.value=!0;try{const e=new FormData;n.value.trim()!==""&&e.append("instruction",n.value.trim()),m.value.forEach(s=>{e.append("CourseScheduleFiles",s.file)});const t=yield X.post("http://localhost:5000/dispatch_center/execute",e,{headers:{"Content-Type":"multipart/form-data"}});if(t.data.code!==200)throw new Error(t.data.message||"请求处理失败");if((l=t.data.data)!=null&&l.has_file){const k=`http://localhost:5000/dispatch_center/download?token=${t.data.data.file_token}`;window.open(k,"_blank"),z.success("文件下载已开始")}M.value=t.data.message||"任务处理成功",z.success(M.value),m.value=[],n.value=""}catch(e){console.error("执行失败:",e),z.error(`操作失败: ${e.message}`)}finally{y.value=!1}}}),V=i(null),H=()=>{var l;(l=V.value)==null||l.click()};return(l,e)=>{const t=T("el-icon"),s=T("el-button"),k=T("el-tooltip");return c(),f("div",null,[a("div",ce,[o(t,{size:40,color:"#1a8efa"},{default:r(()=>[o(C(J))]),_:1}),e[1]||(e[1]=a("h1",{class:"welcome-text"},"欢迎使用教务助手！",-1)),e[2]||(e[2]=a("p",{class:"welcome-subtext"},"在这里，您可以轻松管理课程、考试和考勤等信息。",-1))]),a("div",ue,[a("div",re,[K(a("input",{"onUpdate:modelValue":e[0]||(e[0]=p=>n.value=p),type:"text",placeholder:"在此输入消息，可上传文件。如下载失败，请检查浏览器是否阻止下载。",class:"input-box"},null,512),[[P,n.value]]),m.value.length?(c(),f("div",de,[(c(!0),f(b,null,w(m.value,(p,_)=>(c(),f("span",{key:_,class:"file-item"},[o(t,null,{default:r(()=>[(c(),N(U(p.icon)))]),_:2},1024),a("span",null,F(p.name),1),o(s,{type:"danger",size:"small",circle:"",onClick:v=>j(_)},{default:r(()=>[o(t,null,{default:r(()=>[o(C(Z))]),_:1})]),_:2},1032,["onClick"])]))),128))])):O("",!0),a("div",pe,[a("input",{ref_key:"fileInput",ref:V,type:"file",style:{display:"none"},multiple:"",onChange:$},null,544),o(k,{content:"上传文件",placement:"top"},{default:r(()=>[o(s,{type:"primary",circle:"",onClick:H,class:"file-upload-button"},{default:r(()=>[o(t,{size:"18"},{default:r(()=>[o(C(Q))]),_:1})]),_:1})]),_:1}),o(s,{type:"primary",loading:y.value,class:"send-button",onClick:G,disabled:!R.value},{default:r(()=>e[3]||(e[3]=[W(" 上传 ")])),_:1},8,["loading","disabled"])])])]),a("div",fe,[(c(!0),f(b,null,w(u.value,(p,_)=>(c(),f("div",{key:_,class:"feature-group"},[(c(!0),f(b,null,w(p,v=>(c(),f("div",{key:v.title,class:"feature-card",style:ee({backgroundColor:v.color}),onClick:v.onClick},[o(t,{size:40,color:"#409EFF"},{default:r(()=>[(c(),N(U(v.icon)))]),_:2},1024),a("h3",null,F(v.title),1),a("p",null,F(v.description),1)],12,me))),128))]))),128))])])}}}),ge=ie(_e,[["__scopeId","data-v-0a5ad10a"]]);export{ge as default};
