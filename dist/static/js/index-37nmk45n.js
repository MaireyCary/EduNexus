var M=(S,_,v)=>new Promise((E,x)=>{var g=o=>{try{s(v.next(o))}catch(p){x(p)}},C=o=>{try{s(v.throw(o))}catch(p){x(p)}},s=o=>o.done?E(o.value):Promise.resolve(o.value).then(g,C);s((v=v.apply(S,_)).next())});import{d as R,r as i,c as V,f,g as u,i as l,h as n,j as d,u as I,aA as q,k as y,v as H,p as J,aB as K,F as w,l as F,m as O,a as Q,z as T,C as W,s as N,a5 as U,t as z,aC as X,$ as Y,aD as Z,aE as ee,aF as te,aG as oe,_ as le}from"./index-CByx5aOp.js";const ne={class:"welcome-message"},ae={class:"message-input-container"},se={class:"input-container"},ce={key:0,class:"upload-status"},ie={class:"button-group"},ue={class:"feature-section slide-in"},re=["onClick"],de=R({__name:"index",setup(S){i([{title:"新的课程安排发布",content:"本学期的部分课程安排已经更新，请各位同学及时查看。",date:"2024-11-01"},{title:"考试时间调整",content:"原定于下周的数学考试时间调整到下下周，请同学们做好准备。",date:"2024-10-25"}]);const _=W(),g=i([{icon:Z,title:"课程管理",description:"查看和管理本学期的课程安排。",color:"#f7f7f7",onClick:()=>{_.push("/schedule")}},{icon:ee,title:"考试管理",description:"查询和调整考试时间表。",color:"#f7f7f7",onClick:()=>{_.push("/exam")}},{icon:te,title:"考勤管理",description:"管理学生的考勤情况。",color:"#f7f7f7",onClick:()=>_.push("/attendance")},{icon:oe,title:"关于本系统",description:"查看本系统的相关信息。",color:"#f7f7f7",onClick:()=>{_.push("/About")}}]);i(""),i(!1),i("");const C=V(()=>Array.from({length:Math.ceil(g.value.length/4)},(e,t)=>g.value.slice(t*4,t*4+4))),s=i(""),o=i([]),p=i(!1),$=V(()=>s.value.trim()!==""||o.value.length>0),A={pdf:"el-icon-document",doc:"el-icon-document",docx:"el-icon-document",xls:"el-icon-s-data",xlsx:"el-icon-s-data",ppt:"el-icon-picture-outline-round",pptx:"el-icon-picture-outline-round",jpg:"el-icon-picture",jpeg:"el-icon-picture",png:"el-icon-picture",zip:"el-icon-folder",rar:"el-icon-folder",default:"el-icon-paperclip"},j=a=>{const e=a.target,t=e.files;t&&t.length>0&&(Array.from(t).forEach(c=>{var r;const h=((r=c.name.split(".").pop())==null?void 0:r.toLowerCase())||"default",b=A[h]||A.default;o.value.push({name:c.name,icon:b,file:c})}),e.value="")},L=a=>{o.value.splice(a,1)},D=i(""),P=()=>M(this,null,function*(){var a;if(!p.value){p.value=!0;try{const e=new FormData;s.value.trim()!==""&&e.append("instruction",s.value.trim()),o.value.forEach(c=>{e.append("CourseScheduleFiles",c.file)});const t=yield Q.post("http://localhost:5000/dispatch_center/execute",e,{headers:{"Content-Type":"multipart/form-data"}});if(t.data.code!==200)throw new Error(t.data.message||"请求处理失败");if((a=t.data.data)!=null&&a.has_file){const h=`http://localhost:5000/dispatch_center/download?token=${t.data.data.file_token}`;window.open(h,"_blank"),T.success("文件下载已开始")}D.value=t.data.message||"任务处理成功",T.success(D.value),o.value=[],s.value=""}catch(e){console.error("执行失败:",e),T.error(`操作失败: ${e.message}`)}finally{p.value=!1}}}),B=i(null),G=()=>{var a;(a=B.value)==null||a.click()};return(a,e)=>{const t=y("el-icon"),c=y("el-button"),h=y("Plus"),b=y("el-tooltip");return u(),f("div",null,[l("div",ne,[n(t,{size:40,color:"#ff6f61"},{default:d(()=>[n(I(q))]),_:1}),e[1]||(e[1]=l("h1",{class:"welcome-text"},"欢迎使用教务助手！",-1)),e[2]||(e[2]=l("p",{class:"welcome-subtext"},"在这里，您可以轻松管理课程、考试和考勤等信息。",-1))]),l("div",ae,[l("div",se,[H(l("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.value=r),type:"text",placeholder:"在此输入消息，可上传文件。如下载失败，请检查浏览器是否阻止下载。",class:"input-box"},null,512),[[K,s.value]]),o.value.length?(u(),f("div",ce,[(u(!0),f(w,null,F(o.value,(r,k)=>(u(),f("span",{key:k,class:"file-item"},[n(t,null,{default:d(()=>[(u(),N(U(r.icon)))]),_:2},1024),l("span",null,z(r.name),1),n(c,{type:"danger",size:"small",circle:"",onClick:m=>L(k)},{default:d(()=>[n(t,null,{default:d(()=>[n(I(X))]),_:1})]),_:2},1032,["onClick"])]))),128))])):J("",!0),l("div",ie,[l("input",{ref_key:"fileInput",ref:B,type:"file",style:{display:"none"},multiple:"",onChange:j},null,544),n(b,{content:"上传文件",placement:"top"},{default:d(()=>[n(c,{type:"primary",circle:"",onClick:G,class:"file-upload-button"},{default:d(()=>[n(t,null,{default:d(()=>[n(h)]),_:1})]),_:1})]),_:1}),n(c,{type:"primary",loading:p.value,class:"send-button",onClick:P,disabled:!$.value},{default:d(()=>e[3]||(e[3]=[O(" 上传 ")])),_:1},8,["loading","disabled"])])])]),l("div",ue,[(u(!0),f(w,null,F(C.value,(r,k)=>(u(),f("div",{key:k,class:"feature-group"},[(u(!0),f(w,null,F(r,m=>(u(),f("div",{key:m.title,class:"feature-card",style:Y({backgroundColor:m.color}),onClick:m.onClick},[n(t,{size:40,color:"#409EFF"},{default:d(()=>[(u(),N(U(m.icon)))]),_:2},1024),l("h3",null,z(m.title),1),l("p",null,z(m.description),1)],12,re))),128))]))),128))])])}}}),me=le(de,[["__scopeId","data-v-9cae5610"]]);export{me as default};
